
{% extends 'base.html' %}
{% load static %}

{% block content %}

<!-- ========================= SECTION PAGETOP ========================= -->
<section class="section-pagetop bg">
	<div class="container">
		{% if 'search' in request.path %}
		<h4 class="title-page">Search Results</h4>
		{% else %}
		<h2 class="title-page">Our Store</h2>
		{% endif %}
	</div> <!-- container //  -->
</section>
<!-- ========================= SECTION INTRO END// ========================= -->

<!-- ========================= SECTION CONTENT ========================= -->
<section class="section-content p-2">
	<div class="container">
		
		
		<div class="row">
			<aside class="col-md-3">
				
				<div class="card">
					<div class="card-body">
					<form action="{% url 'search_size' %}" method="GET" class="search">
                        
                        <div class="form-group row">
                            
                            <label class="col-sm-4" for="width">Width</label>
                            <div class="col-sm-6"> 
                                <select class="form-control" onclick="getsizes('width');" id="width"name="width">
									
                                    <option>Width</option>
                                    {% for width in width %}
									{% if width.width == swidth %}
									<option selected>{{ width.width }}</option>
									{% else %}
                                    <option>{{ width.width }}</option>
									{% endif %}
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group row">
                            <label class="col-sm-4" for="profile">Profile</label>
                            <div class="col-sm-6"> 
                                <select class="form-control" onclick="getsizes('profile');" id="profile"name="profile">
                                    
                                    <option>Profile</option>

                                    
									<option selected>{{ sprofile }}</option>
									 
                                </select>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-sm-4" for="diameter">Rim Size</label>
                            <div class="col-sm-6"> 
                                <select class="form-control"  id="diameter"name="diameter">
                                    
                                    <option>Rim Size</option>
                                    <option selected>{{ sdiameter }}</option>
						
                                </select>
                            </div>
                            
                            
                        </div>
                        
                        <input type="hidden" id="view1"  name="view1" value="view1">
                        
                        <button class="btn btn-primary" type="submit">
                            Filter
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </form> 
					
				</div> 
				</div> <!-- card.// -->
				
			</aside> <!-- col.// -->
			<main class="col-md-9">
				
				
				
				<header class="border-bottom mb-4 pb-3">
					<div class="form-inline">
						<span class="mr-md-auto">{{ product_count }} Items found </span>
						
					</div>
				</header><!-- sect-heading -->
				
				 
				
				<div class="row">
					
					<table class="table">
						<tr>
							<th>Product</th>
							<th>Country</th>
							<th>Price</th>
						</tr>
						
						{% if products %}
						
						{% for product in products %}
						
						<tr>
							<td><a href="{{ product.get_url }}"> {{ product.product_name }}</a></td>
							<td><a href="{{ product.get_url }}">{{ product.country }}</a></td>
							<td><a href="{{ product.get_url }}">{{ product.price }}</a></td>	
						</tr>
						
						{% endfor %}
					</table>
					
					{% else %}
					<h2>No Results Found. Please try again</h2>
					{% endif %}
				</div> <!-- row end.// -->
				
				

				
				
				
				
				 
			</main> <!-- col.// -->
			
		</div>
		
	</div> <!-- container .//  -->
</section>
<!-- ========================= SECTION CONTENT END// ========================= -->

<!-- ========================= FOOTER ========================= -->
<footer class="section-footer border-top padding-y">
	<div class="container">
		<p class="float-md-right"> 
			&copy Copyright 2019 All rights reserved
		</p>
		<p>
			<a href="#">Terms and conditions</a>
		</p>
	</div><!-- //container -->
</footer>


<script>
 
	
	function getsizes(cmbselect) {
		
		
		// preventing from page reload and default actions
		
		// serialize the data for sending the form data.
		var serializedData = $(this).serialize();
		// make POST ajax call
		
		var data = new FormData();
		
		if (cmbselect == "width") {
			var dataString = "width="+ document.getElementById("width").value;
		}
		if (cmbselect == "profile") {
			var dataString = "width="+ document.getElementById("width").value + "&profile="+ document.getElementById("profile").value;
		}
		
		
		
		$.ajax({
			type: 'GET',
			url: "{% url 'get_sizes' %}",
			data: dataString,
			success: function (response) {
				if (cmbselect == "width") {
					var mySelect = document.getElementById('profile');
					mySelect.options.length = 0;
					mySelect.options[0] = new Option ("Profile", "Profile");
					i = 1;
					response.width.forEach(function (item) { 
						mySelect.options[i] = new Option (item.height, item.height);
						i = i +1;
					}); 
					var mySelect = document.getElementById('diameter');
					mySelect.options.length = 0;
					mySelect.options[0] = new Option ("Rim Size", "Rim Size");
					
				}
				
				if (cmbselect == "profile") {
					var mySelect = document.getElementById('diameter');
					mySelect.options.length = 0;
					mySelect.options[0] = new Option ("Rim Size", "Rim Size");
					i = 1;
					response.width.forEach(function (item) { 
						mySelect.options[i] = new Option (item.diameter, item.diameter);
						i = i +1;
					}); 
				}
				
				
			},
			error: function (response) {
				// alert the error if any error occured
				alert(response["responseJSON"]["error"]);
			}
		})
	}
	
	
	
	
	
</script>
<!-- ========================= FOOTER END // ========================= -->
{% endblock %}